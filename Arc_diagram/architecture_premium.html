<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JurisLens Architecture</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;700&display=swap');

        :root {
            --bg-color: #0f172a;
            --card-bg: rgba(30, 41, 59, 0.8);
            --card-border: rgba(148, 163, 184, 0.1);
            --text-primary: #cbd5e1;
            --text-heading: #f8fafc;
        }

        body {
            font-family: 'Outfit', sans-serif;
            background-color: var(--bg-color);
            background-image:
                radial-gradient(at 0% 0%, rgba(56, 189, 248, 0.15) 0px, transparent 50%),
                radial-gradient(at 100% 100%, rgba(16, 185, 129, 0.15) 0px, transparent 50%);
            margin: 0;
            padding: 20px;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--text-primary);
            overflow: hidden;
        }

        .layout {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            /* 3 Columns */
            grid-template-rows: auto auto auto;
            /* 3 Rows */
            gap: 40px 60px;
            /* Vertical Gap, Horizontal Gap */
            position: relative;
            width: 1000px;
            max-width: 100%;
            padding: 40px;
            /* Debug */
            /* border: 1px dashed red; */
        }

        /* SVG Overlay for Connectors */
        .svg-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none;
        }

        .connector {
            fill: none;
            stroke: #64748b;
            stroke-width: 2;
            stroke-dasharray: 6;
            animation: dash 30s linear infinite;
            opacity: 0.5;
        }

        .connector.active {
            stroke: #10b981;
            opacity: 0.8;
            stroke-dasharray: none;
        }

        @keyframes dash {
            to {
                stroke-dashoffset: -1000;
            }
        }

        /* Card Styles */
        .card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            position: relative;
            z-index: 2;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 140px;
            transition: transform 0.3s;
        }

        .card:hover {
            transform: translateY(-5px);
            border-color: rgba(255, 255, 255, 0.3);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.2);
        }

        /* Specific Grid Positions */
        #node-user {
            grid-column: 2;
            /* Center */
            grid-row: 1;
            border-top: 4px solid #fff;
        }

        #node-agent {
            grid-column: 2;
            /* Center */
            grid-row: 2;
            border: 2px solid #10b981;
            box-shadow: 0 0 40px rgba(16, 185, 129, 0.15);
            transform: scale(1.1);
            /* Make it bigger */
        }

        #node-llm {
            grid-column: 3;
            /* Right */
            grid-row: 2;
            border-left: 4px solid #3b82f6;
        }

        #node-elastic {
            grid-column: 1;
            grid-row: 3;
            border-bottom: 4px solid #f59e0b;
        }

        #node-risk {
            grid-column: 2;
            grid-row: 3;
            border-bottom: 4px solid #ef4444;
        }

        #node-sanctions {
            grid-column: 3;
            grid-row: 3;
            border-bottom: 4px solid #f43f5e;
        }

        /* Typography & Icons */
        .icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: rgba(255, 255, 255, 0.05);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        h3 {
            margin: 5px 0;
            color: white;
            font-size: 1.1rem;
        }

        p {
            margin: 0;
            font-size: 0.85rem;
            color: #94a3b8;
            line-height: 1.4;
        }

        .tag {
            font-size: 0.7rem;
            font-weight: bold;
            letter-spacing: 1px;
            text-transform: uppercase;
            margin-top: 8px;
            padding: 4px 8px;
            border-radius: 4px;
        }
    </style>
</head>

<body>

    <div class="layout">
        <!-- Lines Layer -->
        <svg class="svg-overlay" id="svg-layer">
            <defs>
                <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto"
                    markerUnits="strokeWidth">
                    <path d="M0,0 L0,6 L9,3 z" fill="#64748b" />
                </marker>
                <marker id="arrow-active" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto"
                    markerUnits="strokeWidth">
                    <path d="M0,0 L0,6 L9,3 z" fill="#10b981" />
                </marker>
            </defs>
            <!-- Paths will be drawn by JS -->
        </svg>

        <!-- Row 1: User -->
        <div id="node-user" class="card">
            <div class="icon">üë§</div>
            <h3>Compliance Officer</h3>
            <p>Uploads PDF & Asks Questions</p>
        </div>

        <!-- Row 2: Agent & LLM -->
        <div id="node-agent" class="card">
            <div class="icon" style="background: rgba(16,185,129,0.2)">ü§ñ</div>
            <h3>JurisLens Agent</h3>
            <p>Orchestrator & Reasoning</p>
            <span class="tag" style="color: #10b981; background: rgba(16,185,129,0.1)">CORE BRAIN</span>
        </div>

        <div id="node-llm" class="card">
            <div class="icon" style="background: rgba(59,130,246,0.2)">üß†</div>
            <h3>OpenAI GPT-4</h3>
            <p>Inference Engine</p>
        </div>

        <!-- Row 3: Tools -->
        <div id="node-elastic" class="card">
            <div class="icon" style="background: rgba(245,158,11,0.2)">üîç</div>
            <h3>Elasticsearch</h3>
            <p>Hybrid Search (Vector + Key)</p>
            <span class="tag" style="color: #f59e0b; background: rgba(245,158,11,0.1)">KNOWLEDGE</span>
        </div>

        <div id="node-risk" class="card">
            <div class="icon" style="background: rgba(239,68,68,0.2)">üìä</div>
            <h3>Risk Ledger</h3>
            <p>Live Transaction State</p>
            <span class="tag" style="color: #ef4444; background: rgba(239,68,68,0.1)">STATEFUL</span>
        </div>

        <div id="node-sanctions" class="card">
            <div class="icon" style="background: rgba(244,63,94,0.2)">üö´</div>
            <h3>Sanctions List</h3>
            <p>Global Watchlist Check</p>
        </div>
    </div>

    <script>
        function drawLine(startId, endId, active = false) {
            const svg = document.getElementById('svg-layer');
            const start = document.getElementById(startId);
            const end = document.getElementById(endId);
            const layout = document.querySelector('.layout');

            if (!start || !end) return;

            const startRect = start.getBoundingClientRect();
            const endRect = end.getBoundingClientRect();
            const containerRect = layout.getBoundingClientRect();

            // Calculate centers relative to container
            const x1 = startRect.left + startRect.width / 2 - containerRect.left;
            const y1 = startRect.top + startRect.height / 2 - containerRect.top;
            const x2 = endRect.left + endRect.width / 2 - containerRect.left;
            const y2 = endRect.top + endRect.height / 2 - containerRect.top;

            const path = document.createElementNS("http://www.w3.org/2000/svg", "path");

            // Logic for nice curves
            let d = "";
            if (x1 === x2) {
                // Vertical
                d = `M ${x1} ${y1 + startRect.height / 2} L ${x2} ${y2 - endRect.height / 2}`;
            } else {
                // Curved logic
                // Start from bottom of 1 to top of 2?
                // Or side to side?

                // If Agent -> Elastic (Left diagonal)
                if (y2 > y1) {
                    // Downward curve
                    d = `M ${x1} ${y1 + startRect.height / 2} C ${x1} ${y1 + 100}, ${x2} ${y2 - 100}, ${x2} ${y2 - endRect.height / 2}`;
                } else {
                    // Horizontal (Agent -> LLM)
                    d = `M ${x1 + startRect.width / 2} ${y1} L ${x2 - endRect.width / 2} ${y2}`;
                }
            }

            path.setAttribute("d", d);
            path.setAttribute("class", active ? "connector active" : "connector");
            path.setAttribute("marker-end", active ? "url(#arrow-active)" : "url(#arrow)");

            svg.appendChild(path);
        }

        window.addEventListener('load', () => {
            // Clear existing paths if any redo logic
            document.getElementById('svg-layer').innerHTML += "";

            drawLine('node-user', 'node-agent');
            drawLine('node-agent', 'node-llm');
            drawLine('node-agent', 'node-elastic', true);
            drawLine('node-agent', 'node-risk', true);
            drawLine('node-agent', 'node-sanctions', true);
        });

        // Redraw on resize
        window.addEventListener('resize', () => window.location.reload());
    </script>
</body>

</html>